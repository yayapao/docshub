---
id: iosapp
title: ''
sidebar_label: IOS App
---

import { DocsHeader } from '/src/components/Layout/DocsHeader'
import { HighlightWithText } from '/src/components/Highlights'

<DocsHeader
  title="React Native Application(ios)"
  description="基于 React Native 从 0 到 1 创建一个 ios 应用"
  tags={['React Native']}
  links={[
    {
      link: 'https://medium.com/@vimniky/how-to-use-vector-icons-in-your-react-native-project-8212ac6a8f06',
      label: 'How to use vector icons in your react-native project',
    },
  ]}
/>{' '}

:::info

React Native 可以看成是 React 在 ios/android 运行环境的实现，它提供编译器将 jsx 语法转换成 ios/android 原生组件，同时提供了一套原生组件的封装。

:::

众所周知，React 通过建立内存 DOM，即虚拟数来进行 Diff 比较、计算后，调用浏览器 API 进行重新渲染。那么只要我们能够掌握不同运行时或者执行环境下的底层渲染接口，这一套逻辑仍然行之有效。

React Native 正是利用 Bridge 和 Virtual DOM 来在手机端内进行。

**RN 与 React 的区别？**

- 元素标签，实际上在于浏览器和手机端的渲染方式不同，其支持原生组件不同，从而导致了标签的差异
- 生命周期

**React Native 相比 webview 的优势？**

就凭 RN 编译的内容，能够直接使用原生组件渲染，就已经吊打 webview 了。webview 相当于在原生应用内嵌入一个 V8 引擎，然后在这个引擎内运行一个网页，天然存在安全、性能、样式交互问题。

## 环境准备

查看 [Setting up the development environment · React Native](https://reactnative.dev/docs/environment-setup) 这里介绍通过 React-Native-CLI 进行安装，需要：

- Node.js > 18，通过 volta 解决
- watchman，`brew install watchman`
- Xcode > 12.5，通过 App Store 安装
- CocoaPods，管理 ios 依赖
- Metro，React Native 的打包工具

准备完毕之后，执行 `npx react-native@latest init AwesomeProject` 创建项目，**注意项目名称**，初始化完毕之后，按照提示继续执行：

```bash
# 仅针对 ios
Run instructions for iOS:
  • cd "/Users/yango/github/apps/joyappRn/ios"

  • Install Cocoapods
    • bundle install # you need to run this only once in your project.
    • bundle exec pod install # 如果遇到问题，尝试执行 pod repo update 更新本地仓库
    • cd ..

  • npx react-native run-ios
  - or -
  • Open joyappRn/ios/joyappRn.xcodeproj in Xcode or run "xed -b ios"
  • Hit the Run button

```

### 在真机上运行

查看 [Running On Device · React Native](https://reactnative.dev/docs/running-on-device)，这里浓缩步骤：

- 通过 Xcode 打开 **ios/xxx.xcworkspace**，分别确认项目名称、签名、bundle id 等信息
- 之后在导航栏选择设备，点击运行即可，这个过程中可能会遇到一些问题，**尝试重启 Xcode、电脑、手机**

**注意让电脑信任手机设备，让手机设备信任开发者证书。**

遇到代码更新后，无法在真机上运行的问题，可以尝试：

- 清除缓存，`npx react-native start --reset-cache`
- 重新编译，`npx react-native run-ios`

## 选择 UI 库

我们选择 [react-native-paper](https://callstack.github.io/react-native-paper/docs/guides/getting-started) 作为 UI 库，它提供了一套 Material Design 风格的组件，同时提供了一些常用的功能组件。

直接安装即可，这里特别说明引入 Icon 的方式：在 react-native-paper 内很多组件都需要使用 [oblador/react-native-vector-icons: Customizable Icons for React Native with support for image source and full styling.](https://github.com/oblador/react-native-vector-icons) 这个库，所以我们需要安装这个库，并将其资源拷贝到 ios 项目内，并编辑 `Info.plist` 文件。

:::warning

添加 icon 文件之后，需要重新编译

:::

完成之后，通过 `import Icon from 'react-native-vector-icons/FontAwesome'` 即可使用

```tsx
import Icon from 'react-native-vector-icons/FontAwesome'
const myButton = (
  <Icon.Button
    name="facebook"
    backgroundColor="#3b5998"
    onPress={this.loginWithFacebook}
  >
    Login with Facebook
  </Icon.Button>
)
```

## 封装请求方法

## Q&A

[CocoaPods could not find compatible versions](https://github.com/rnmods/react-native-document-picker/issues/313)

- 通过 `cd ios && pod install --repo-update` 解决
