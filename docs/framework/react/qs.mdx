---
id: qs
title: ''
sidebar_label: 'React Questions'
---

import { DocsHeader } from '/src/components/Layout/DocsHeader'

<DocsHeader
  title="Questions about React"
  description="å¯¹ React ç”Ÿäº§é—®é¢˜çš„æ·±åº¦æ€è€ƒğŸ¤”ã€‚"
  tags={['React']}
  links={[
    {
      label: 'Why does useRef solve the problem of stale state?',
      link: 'https://stackoverflow.com/questions/66622967/why-does-useref-solve-the-problem-of-stale-state',
    },
    {
      label: 'Rename A File With JavaScript In The Browser',
      link: 'https://pqina.nl/blog/rename-a-file-with-javascript/',
    },
  ]}
/>

## åœ¨ React å†…å¦‚ä½•å¤„ç†æ–‡ä»¶å¯¹è±¡ï¼Ÿ

:::warning Before we start

[File](https://developer.mozilla.org/en-US/docs/Web/API/File) å¯ä»¥çœ‹ä½œæ˜¯ Blob çš„ä¸€ç§ç‰¹æ®Šå®ç°ï¼Œå› æ­¤å®ƒå…·å¤‡ Blob çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜ `name`, `lastModified` ä»¥åŠ `webkitRelativePath` ç­‰å±æ€§

**æ­£æ˜¯ç”±äº File çš„å±æ€§ä¸º readonlyï¼Œä½¿æˆ‘ä»¬åœ¨è¯•å›¾æ”¹å˜å®ƒæ—¶é‡åˆ°éº»çƒ¦ã€‚**

:::

æœ¬ç« èŠ‚ï¼Œæˆ‘å°†åŸºäº React ç»“åˆ [filepond](https://pqina.nl/filepond/docs/) æ¥ä»‹ç»åœ¨ç°ä»£æ¡†æ¶å†…**å¤„ç†ä¸Šä¼ æ–‡ä»¶çš„éœ€æ±‚**ï¼ŒåŒæ—¶æä¾›è®¾è®¡ä¸Šä¼ ç»„ä»¶çš„æ€è·¯å’Œç»†èŠ‚ã€‚

è§‚å¯Ÿ filepond æˆ‘å‘ç°ï¼Œå®ƒåœ¨å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œæ”¯æŒï¼š

- åœ¨æ–‡ä»¶å¯¹è±¡è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œé€šè¿‡å†…ç½®å’Œè‡ªå®šä¹‰æ’ä»¶ï¼Œæ›´æ”¹æ–‡ä»¶å¯¹è±¡ï¼Œæ¯”å¦‚é‡å‘½åã€é¢„è§ˆç­‰æ“ä½œ
- å¯¹äºå·²ä¸Šä¼ æ–‡ä»¶ï¼Œæ”¯æŒé»˜è®¤åˆ é™¤æ“ä½œï¼Œä¼šåŒæ—¶åˆ é™¤æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ–‡ä»¶å¯¹è±¡

filepond ä¸ºäº†è§„é¿ File å¯¹è±¡çš„åªè¯»å±æ€§ï¼Œé‡‡ç”¨äº†ä»¥ä¸‹æ–¹æ¡ˆï¼š

1. å½“ç”¨æˆ·ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªåªè¯»çš„ File å¯¹è±¡ï¼›
2. filepond æ’ä»¶åŸºäºåŸ File å¯¹è±¡ï¼Œåˆ›å»ºæ–°çš„ File å¯¹è±¡æ¥è§„é¿åªè¯»çš„é™åˆ¶ï¼›
3. åŸºäº File å¯¹è±¡ç”Ÿæˆæœ¬åœ° URL æ¥é¢„è§ˆå›¾ç‰‡ï¼›
4. æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éœ€è¦è¾¾æˆæŸç§çº¦å®šï¼Œå³å½“ä¸Šä¼ æˆåŠŸåï¼Œå°†æ–‡ä»¶ ID ä»¥çº¦å®šå½¢å¼è¿”å›ï¼Œç»„ä»¶ä»ç»“æœå†…å–å‡ºåæ”¾å»å†…å­˜ï¼Œä»è€Œè¿›è¡Œåç»­åˆ é™¤ç­‰æ“ä½œï¼›
5. ä¸åŒæµè§ˆå™¨åœ¨å¤„ç† File å¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šå°†å…¶è½¬æ¢ä¸º Blob å¯¹è±¡ï¼Œ**æœåŠ¡ç«¯æ¥æ”¶ Blob å¯¹è±¡åï¼Œä¼šå°†å…¶ filename è§£ææˆ blob**ã€‚å› æ­¤ï¼Œéœ€è¦ç¡®ä¿ä¸Šä¼ æ•°æ®ä¸º File å¯¹è±¡ï¼›

### å¦‚ä½•åœ¨å®¢æˆ·ç«¯å¯¹ File å¯¹è±¡è¿›è¡Œé‡å‘½åï¼Ÿ

ä»¥é‡å‘½åä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬éœ€è¦æ›´æ”¹ File çš„å±æ€§æ—¶ï¼Œ**ç›®å‰æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆæ—¶ï¼Œä»¥åŸ File å¯¹è±¡ä¸ºåŸºç¡€ï¼Œç”Ÿäº§ä¸€ä¸ªæ–°çš„ Blob å¯¹è±¡ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º File å¯¹è±¡ã€‚**

_ä¸ºä»€ä¹ˆä¸æ˜¯ç›´æ¥ç”Ÿäº§ File å¯¹è±¡ï¼Ÿ_

- ä¸åŒæµè§ˆå™¨å¯¹äº File å¯¹è±¡çš„å¤„ç†å­˜åœ¨å·®å¼‚
- `Blob.slice` ä¼šè¿”å›ä¸€ä¸ª Blob å¯¹è±¡

```js
const renameFile = (file, name) => {
  // æ–°å»ºä¸€ä¸ª Blob å¯¹è±¡ï¼ŒæŒ‡å®šå¼€å§‹/ç»“æŸä½ç½®å’Œæ•°æ®ç±»å‹ï¼Œå¹¶ä¸ºå…¶é‡å‘½å
  const renamedFile = file.slice(0, file.size, file.type)
  renamedFile.lastModifiedDate = file.lastModifiedDate
  renamedFile.name = name
  // å°† Blob å¯¹è±¡è½¬æ¢ä¸º File
  const form = new FormData()
  form.set('file', renamedFile, name)
  return form.get('file')
}
```

### å¦‚ä½•å®ç°æœ¬åœ°é¢„è§ˆæ–‡ä»¶ï¼Ÿ

è¿™é‡Œç‰¹æŒ‡æµè§ˆå™¨å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ image/\*, SVG, ä»¥åŠ PDF ç­‰æ ¼å¼æ–‡ä»¶ã€‚

1. é€šè¿‡ `window.URL.createObjectURL(file)` æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªé“¾æ¥ï¼Œå°†è¿”å›å€¼æ”¾å…¥ img.src å±æ€§å†…ï¼›
2. é€šè¿‡ `FileReader` å°†æ–‡ä»¶å†…å®¹è½¬ä¸º base64 æ ¼å¼ï¼Œè¿›è¡Œè¯»å–ï¼›

```js filereader
var fileReader = new FileReader()

reader.onload = function (e) {
  // base64 ç¼–ç 
  const res = e.target.result
}
reader.readAsDataURL(file)
```
