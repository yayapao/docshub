---
id: practice
title: practice
---

### 如何获取命令行内参数？

在执行类似 `zx control.mjs build params1 params2` 命令时，我们可以通过 [node.js-process.argv](http://nodejs.cn/api/process/process_argv.html) 来获取执行参数

相较于 `node control.js` 直接执行指定脚本的形式，通过 zx 执行会存在一点区别：通常来说，`process.argv` 返回一个指定顺序的数组：

1. 第一个元素是 `process.execPath`, 通常是 node 的执行文件路径；
2. 第二个元素是正在执行的 javascript 文件，由于 zx 作为中间层，因此在执行 zx 脚本时，指向的是 zx 的执行文件路径，**区别就在于此**；
3. 剩下的会按照顺序依次填入数组；

## 用 `process.hrtime.bigint()` 来计算时间间隔

:::caution why not console.time

通过 `console.time(label) && console.timeEnd(label)` 启动计时器来跟踪某一操作的占用时长，**label 必须是唯一的且能够被转换为 String 类型**。在 Node.js 中，如果一个接口被多次调用，则会产生不必要的警告。

:::

因此，在 nodejs 内提供了 [process.hrtime.bigint()](https://nodejs.org/api/process.html#process_process_hrtime_bigint) 来进行更精确的测量，它能够以纳秒级来标记当前时间。

我们先来看看 `console.time` && `console.timeEnd`

```js
console.time(a) // => undefined
console.timeEnd(a) // => undefined, 但是会在控制台打印 191051479007711: 35843.951171875 ms

// 当 label 不能被转换为 String 类型时会报错
const s = Symbol()
console.time(s) // => Uncaught TypeError: Cannot convert a Symbol value to a string
```

对于 `process.hrtime.bigint()` 的使用很简单，将两个节点做差值计算即可，注意：

- Node.js 版本在 v10.7.0 以上
- 返回值为 bigint 类型，单位转换时要做类型转换

```js
process.hrtime.bigint() // => 21818700313170n (纳秒)
const st = process.hrtime.bigint()
typeof st // => 'bigint'

st / 1000 // => Uncaught TypeError: Cannot mix BigInt and other types, use explicit conversions
// 因此需要先将 bigint 转换为 number 类型，再进行计算
Number(st) / 1000 // => 21818700313.17 (微秒)
```
