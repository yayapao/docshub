---
id: self_hosted
title: ''
sidebar_label: Self Hosted
---

import { DocsHeader } from '/src/components/Layout/DocsHeader'

<DocsHeader
  title="Sentry Self Hosted"
  description="å¯¹äºå¼€æºé¡¹ç›®ï¼Œå‡ºäºæ•°æ®å®‰å…¨å’ŒåŠŸèƒ½æ‹“å±•çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©ç§æœ‰åŒ–éƒ¨ç½²ã€‚"
  github="https://github.com/getsentry/self-hosted"
  tags={['self-hosted']}
  links={[
    {
      label: 'Development Environment',
      link: 'https://develop.sentry.dev/environment/',
    },
  ]}
/>

åœ¨æœ¬ç« èŠ‚ï¼Œæˆ‘ä»¬å°†ç€é‡è®¨è®ºå¦‚ä½•ç§æœ‰åŒ–éƒ¨ç½² Sentry æœåŠ¡ã€‚

## å®˜æ–¹è§£å†³æ–¹æ¡ˆ

å‚è€ƒ[å®˜æ–¹æ¨èç§æœ‰åŒ–éƒ¨ç½²](https://github.com/getsentry/self-hosted) æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ Dokcer-compose å¯åŠ¨æ•´ä¸ªåº”ç”¨ã€‚å®ƒæ˜¯å°† Sentry ä¾èµ–çš„å„ä¸ªæœåŠ¡æŒ‚è½½åˆ° Docker ä¸Šï¼Œé€šè¿‡ Docker-compose æ¥ç»Ÿä¸€ç®¡ç†ã€‚è¾¾åˆ° **All-in-one** çš„æ•ˆæœã€‚

å®˜æ–¹æ¨èçš„ç§æœ‰åŒ–æ–¹å¼èƒ½å¤Ÿå¿«é€Ÿéƒ¨ç½²ä¸Šçº¿ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨æ˜æ˜¾åŠ£åŠ¿ï¼š

- æ•´ä¸ªç³»ç»Ÿéƒ¨ç½²åœ¨å•æœºä¸Šï¼Œæ— æ³•çµæ´»åœ°æ‰©å®¹ï¼Œæ€§èƒ½ç“¶é¢ˆååˆ†æ˜æ˜¾
- æ’éšœå›°éš¾
- æ— æ³•è‡ªå®šä¹‰å¼€å‘

å› æ­¤åœ¨ç”Ÿäº§ç¯å¢ƒå†…ï¼Œæˆ‘ä»¬å°†å…¶å„ä¸ªæœåŠ¡æ‹†è§£å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œä»¥æ­¤æ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚

:::tips why this way works?

Sentry æœ¬èº«åŸºäº redisã€postgresã€Kafka å’Œ CK ç­‰æ•°æ®æœåŠ¡æ¥è¿›è¡ŒæœåŠ¡é—´äº‹ä»¶æµçš„é€šä¿¡ã€å¤„ç†ä»¥åŠæ•°æ®å­˜å‚¨ï¼Œæ¨¡å—ä¹‹é—´å¹¶æœªç›´æ¥ä¾èµ–

:::

## DEVELOPMENT

åœ¨ä¸Šçº¿ç”Ÿäº§ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç°åœ¨æœ¬åœ°å°†å„ä¸ªæœåŠ¡è·‘èµ·æ¥ï¼Œå¹¶ä¸”åœ¨è¿™é‡Œæˆ‘ä»¬ä»…é’ˆå¯¹ Sentry åšè‡ªå®šä¹‰å¼€å‘ã€‚

:::warning

æœ¬ç« èŠ‚ä½¿ç”¨ç³»ç»Ÿå‡ä¸º MacOSï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦äº†è§£ï¼š

- [Installing pip/setuptools/wheel with Linux Package Managers â€” Python Packaging User Guide](https://packaging.python.org/en/latest/guides/installing-using-linux-tools/)

:::

### ç¯å¢ƒå‡†å¤‡

åœ¨ MacOS å†…å¯ä»¥ç›´æ¥æ‰§è¡Œè„šæœ¬ä¸€é”®å®‰è£…ï¼Œå®ƒä¼šå°½åŠ›ç¡®ä¿ MacOS ä¸‹å¼€å‘ç¯å¢ƒä¸€è‡´ã€‚

```bash
bash <(curl -s https://raw.githubusercontent.com/getsentry/bootstrap-sentry/main/bootstrap.sh)
```

åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿè®°å½•æ‰‹åŠ¨å®‰è£…çš„å„ä¸ªæ­¥éª¤ï¼š

æ³¨æ„é™¤æ­¤ä¹‹å¤–è¿˜éœ€è¦å®‰è£… Docker

```bash
# å…‹éš†å®˜æ–¹ä»“åº“ï¼Œå»ºè®®é€‰æ‹©æœ€æ–°çš„ç¨³å®š release ç‰ˆæœ¬
git clone https://github.com/getsentry/sentry.git
cd sentry

# MacOS å®‰è£…ç³»ç»Ÿä¾èµ–
xcode-select --install

# å®‰è£… Brewfile åˆ—ä¸¾çš„ packages
brew bundle --verbose
```

ç”±äº Sentry ä½¿ç”¨ [Python Wheels](https://pythonwheels.com/) æ‰“åŒ…ï¼Œè€Œè¯¥å·¥å…·åŸºäº rustï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦[install rust](https://www.rust-lang.org/tools/install)ã€‚

é€šè¿‡ `rust update stable` æ¥ç¡®ä¿æœ€æ–°ç¨³å®šçš„ rust ç‰ˆæœ¬ã€‚

Sentry åˆ©ç”¨ `pyenv` æ¥ç®¡ç† Python ç‰ˆæœ¬ï¼š

```bash
# å¦‚æœç³»ç»Ÿå†…æ²¡æœ‰ pyenvï¼Œåˆ™é€šè¿‡ brew å®‰è£…
brew install pyenv

# è£… Sentry ä¾èµ–ç¯å¢ƒ
make setup-pyenv
```

- å®‰è£…å®Œæˆä¹‹åï¼Œæ‰§è¡Œ `which python` --> é¢„æœŸå‡ºç° `/usr/bin/python`
- ä¿®æ”¹ `bash_profile`ï¼Œæ·»åŠ  `#pyenv \n eval "$(pyenv init -)" \n export PATH="$HOME/.pyenv/bin:$PATH"` æ¥æŒ‡å®šè·¯å¾„
- æ‰§è¡Œ `eval "$SHELL"` é‡å¯æ§åˆ¶å°
- å†æ¬¡æ‰§è¡Œ `which python` --> é¢„æœŸå‡ºç° `/Users/you/.pyenv/shims/python`ï¼Œç›¸å½“äºåšäº†ä¸€æ¬¡æ‹¦æˆªï¼Œå°† python å‘½ä»¤æ‰˜ç®¡ç»™ pyenv åç»Ÿä¸€å¤„ç†
- åœ¨ sentry æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ `python -m venv .venv` åˆ›å»º python é¡¹ç›®è™šæ‹Ÿæ‰§è¡Œè·¯å¾„
- `source .venv/bin/activate` å¯ç”¨è¿è¡Œç¯å¢ƒ
- æ­¤æ—¶åœ¨è™šæ‹Ÿç¯å¢ƒå†…æ‰§è¡Œ `which python` --> é¢„æœŸå‡ºç° `/Users/you/sentry/.venv/bin/python`

Node.js ç‰ˆæœ¬é€šè¿‡ [volta](https://github.com/volta-cli/volta) ç®¡ç†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚

Sentry é€šè¿‡ `direnv` è‡ªåŠ¨æ¿€æ´»ä½ çš„è™šæ‹Ÿç¯å¢ƒï¼Œè®¾ç½®ä¸€äº›å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨æ£€æµ‹ä½ çš„ç¯å¢ƒæ˜¯å¦å¯ç”¨ï¼Œè¿›å…¥ç›®å½•åå¯ä»¥é€šè¿‡ `direnv allow ` æ¥è¿›è¡Œæ¿€æ´»ã€‚

```bash
brew install direnv

# åœ¨ .zshrc æ–‡ä»¶æœ«å°¾æ·»åŠ 
eval "$(direnv hook zsh)"
```

### å¯åŠ¨é¡¹ç›®

æ‰§è¡Œ `make bootstrap` æ¥åˆå§‹åŒ–é¡¹ç›®ï¼Œå®ƒä¼šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

- `sentry init` åˆ›å»ºåŸºæœ¬é…ç½®æ–‡ä»¶åœ¨ `~/.sentry/`
- `sentry devservices up` ç”¨æ¥å¯åŠ¨ Docker services
- `sentry upgrade` ç”¨æ¥æ‰§è¡Œ Postgres migrationsï¼ˆæ›´æ–°è¡¨ç»“æ„ï¼‰

ä¹‹åå¯ä»¥æ‰§è¡Œ `sentry devserver --workers` æ¥å¯åŠ¨æ•´ä¸ªé¡¹ç›®ã€‚

åœ¨ Docker Dashboard å†…è§‚å¯Ÿ Sentry æœåŠ¡çš„è¿è¡Œæƒ…å†µã€‚Docker services å¯åŠ¨é¡¹é…ç½®åœ¨ `src/sentry/conf/server.py`ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹æ¥çµæ´»è¿›è¡Œé…ç½®ã€‚æ¯”å¦‚ä¿®æ”¹ `pull: False` æ¥ç›´æ¥ä½¿ç”¨æœ¬åœ°çš„é•œåƒã€‚

ç†è®ºä¸Šä¼šå¯åŠ¨å¦‚ä¸‹æœåŠ¡ï¼š

- `sentry_relay` ï¼ˆåœ¨æ¯æ¬¡å¯åŠ¨ sentry æœåŠ¡æ—¶æ‰ä¼šåˆ›å»º containerï¼‰

```
CONTAINER ID   IMAGE                                COMMAND                  CREATED          STATUS                 PORTS                                                                          NAMES
85d2e8ab542b   ghcr.io/getsentry/snuba:latest       "./docker_entrypointâ€¦"   52 minutes ago   Up 52 minutes          127.0.0.1:1218->1218/tcp                                                       sentry_snuba
76f826b6d8b6   confluentinc/cp-kafka:5.1.2          "/etc/confluent/dockâ€¦"   12 months ago    Up 2 hours             127.0.0.1:9092->9092/tcp                                                       sentry_kafka
0277a232111e   confluentinc/cp-zookeeper:5.1.2      "/etc/confluent/dockâ€¦"   12 months ago    Up 2 hours             2181/tcp, 2888/tcp, 3888/tcp                                                   sentry_zookeeper
88daf5f278cc   postgres:9.6-alpine                  "docker-entrypoint.sâ€¦"   12 months ago    Up 2 hours (healthy)   127.0.0.1:5432->5432/tcp                                                       sentry_postgres
bc0a0d455542   redis:5.0-alpine                     "docker-entrypoint.sâ€¦"   12 months ago    Up 2 hours             127.0.0.1:6379->6379/tcp                                                       sentry_redis
c9cb1fa5a2f6   yandex/clickhouse-server:20.3.9.70   "/entrypoint.sh"         12 months ago    Up 2 hours             127.0.0.1:8123->8123/tcp, 127.0.0.1:9000->9000/tcp, 127.0.0.1:9009->9009/tcp   sentry_clickhouse
```

æ³¨æ„ï¼Œå½“åœ¨æœ¬åœ°è¿è¡Œä¸åŒç‰ˆæœ¬çš„ sentry ä»£ç æ—¶ï¼Œæˆ‘ä»¬çš„ä¾èµ–ç¯å¢ƒå¾€å¾€ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¯èƒ½å­˜åœ¨æ—§ç‰ˆæœ¬çš„ snuba å’Œæ–°ç‰ˆæœ¬çš„ sentry ä¸åŒ¹é…çš„ç°è±¡ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿ `server.py` é…ç½®ï¼Œæ¥å•ç‹¬åˆ›å»ºç›¸å…³ containerã€‚

```bash
# å¯åŠ¨æŒ‡å®šæœåŠ¡
sentry devservices up [service]

# æ”¯æŒçš„æœåŠ¡
Services that are available:
redis
postgres
zookeeper
kafka
clickhouse
snuba
relay
```

#### æ³¨æ„äº‹é¡¹

å¦‚æœæœ¬åœ°éœ€è¦è·‘ä¸åŒç‰ˆæœ¬çš„ Sentryï¼Œå¯èƒ½å…¶ä¾èµ–æœåŠ¡éœ€è¦è¿è¡Œä¸åŒç‰ˆæœ¬ï¼Œæ¯”å¦‚ snuba æä¾›äº†æ›´å¤šçš„æ¥å£æ”¯æŒï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘éœ€è¦åšå¥½ç¯å¢ƒåˆ‡æ¢

- å‘ç°ç¼ºå°‘ tableï¼Œé€šè¿‡ `sentry upgrade` æ‰§è¡Œå‡çº§äº‹é¡¹æˆ–è€…æ•°æ®åº“è¿ç§»

å¦‚æœéœ€è¦å‡çº§æŒ‡å®šæœåŠ¡ï¼Ÿ

- è§‚å¯Ÿ `server.py` æŸ¥çœ‹ docker å†…æœåŠ¡çš„é…ç½®å’Œæº
- æ‰‹åŠ¨ä»æºæ‹‰å–é•œåƒåï¼Œè®¾ç½® `"pull": False`ï¼Œè¡¨ç¤ºå¯åŠ¨æ—¶ä¼šä»æœ¬åœ°æ‹‰å–
- æ‰§è¡Œ `sentry devservices attach snuba` æ‰‹åŠ¨å¯åŠ¨ sunba æœåŠ¡
- å¯åŠ¨ Sentry

### æ‰“åŒ…æ„å»º

è¿™é‡Œæˆ‘ä»¬å‚è€ƒæºä»“åº“çš„ `/docker/builder.*` æ–‡ä»¶æ¥æŸ¥çœ‹æ„å»ºæµç¨‹ï¼ŒåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªæ„å»ºè„šæœ¬ã€‚

æœ€ç»ˆæ•ˆæœä¼šåœ¨ dist ç›®å½•ä¸‹ç”Ÿæˆæ„å»ºäº§ç‰©

- **requirements.txt** ç”¨æ¥è¡¨ç¤ºéœ€è¦å®‰è£…çš„ä¾èµ–
- **sentry-[sentry version]-[python version]-none-any.whl** æ‰“åŒ…æ–‡ä»¶

## Relay

æˆ‘ä»¬ä»**æºç ç¼–è¯‘**å’Œ**æ„å»ºé•œåƒ**ä¸¤æ–¹é¢ä»‹ç»å¦‚ä½•åœ¨å®¹å™¨å†…éƒ¨ç½² realy æœåŠ¡ã€‚

### æºç ç¼–è¯‘

è¿™ä¸€æ­¥æˆ‘ä»¬ç›®çš„æ˜¯è·å– relay çš„å¯æ‰§è¡Œæ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€å¿…é¡»ç‰©æ–™

æˆ‘ä»¬è·å–æ„å»ºäº§ç‰©çš„é€”å¾„ï¼š

- æ ¹æ® [relay æºç ](https://github.com/getsentry/relay) æ‰“åŒ…
- [dockerhub](https://hub.docker.com/r/getsentry/relay) å†…è·å–

#### é€šè¿‡ docker container è·å–ï¼ˆğŸ‘ï¼‰

æ€è·¯ï¼šä¸‹è½½å®˜æ–¹é•œåƒï¼Œåœ¨æœ¬åœ°å®¹å™¨å†…å¯åŠ¨ä¹‹åï¼Œé€šè¿‡ `docker cp` å°†å…¶æ‹·è´åˆ°æœ¬åœ°ï¼›ä¸Šä¼ åˆ°å­˜å‚¨æœåŠ¡åï¼Œæ¯æ¬¡æ„å»ºæ‹‰å–æ–‡ä»¶å³å¯ã€‚

å…·ä½“æ­¥éª¤ï¼š

1. å‚è€ƒ Dockerfile.relay.local ç¼–å†™ Dockerfileï¼›
2. æ„å»ºæœ¬åœ°é•œåƒ

```bash
RELAY_VERSION=22.7.0
docker build -f Dockerfile.relay.local -t relay:$RELAY_VERSION --build-arg RELAY_VERSION .
```

3. æµ‹è¯• relay cli èƒ½å¦æ­£å¸¸å¯åŠ¨

```bash
docker run --rm -it -v [absolute config path]:/etc/opt/relay relay:$RELAY_VERSION --help
```

4. è¿è¡Œä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡ `-v` å°† `/etc/opt/relay` æ˜ å°„åˆ°æœ¬åœ° volumnï¼Œå¹¶è®¾ç½® `processing enable: false`ï¼Œ**æ³¨æ„ï¼šæˆ‘ä»¬çš„ç›®çš„åªæ˜¯å°†å®¹å™¨è·‘èµ·æ¥**

```yml
---
relay:
  upstream: 'http://host.docker.internal:8000/'
  host: 0.0.0.0
  port: 3000
logging:
  level: TRACE
  enable_backtraces: true
  format: json
limits:
  shutdown_timeout: 100000
processing:
  enabled: false
```

5. æ‰§è¡Œ `docker cp [container id]:[path] [local host path]` å°†å®¹å™¨å†…æ–‡ä»¶æ‹·è´è‡³æœ¬åœ°ï¼Œéœ€è¦æ‹·è´æ–‡ä»¶åŒ…æ‹¬ï¼š

- **/usr/local/bin/relay** relay çš„äºŒè¿›åˆ¶æ–‡ä»¶
- **/opt/relay/relay.src.zip**
- **/opt/relay/relay-debug.zip**

#### æºç æ‰“åŒ…

æˆ‘ä»¬å‚è€ƒ [relay Dockfile](https://github.com/getsentry/relay/blob/master/Dockerfile) æ¥ç¼–å†™å…·ä½“æ­¥éª¤ã€‚

#### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶åŒ…æ‹¬ï¼š

- **config.yml**
- **credentials.json**

`config.yml` æ ¹æ®å®é™…æƒ…å†µé…ç½®å³å¯ã€‚

`credentials.json` éœ€è¦åœ¨æœ¬åœ°/å®¹å™¨å†…ï¼Œé€šè¿‡ `relay credentials generate` ç”Ÿæˆåè¿›è¡Œä¿å­˜å³å¯ã€‚

#### å…¶ä»–å¿…é¡»ç‰©æ–™

å¿…é¡»ç‰©æ–™ï¼š

- **GeoLite2-City.mmdb** ç›´æ¥åœ¨ä»“åº“å†…ä¸‹è½½å³å¯ï¼Œç”¨æ¥æŒ‡å®šåœ°ç†ä½ç½®æ–‡ä»¶è·¯å¾„

```yml
processing:
  enabled: true
  geoip_path: '/var/cache/geoip/GeoLite2-City.mmdb'
```

### æ„å»ºé•œåƒ

æˆ‘ä»¬å‚è€ƒ [relay Dockfile](https://github.com/getsentry/relay/blob/master/Dockerfile) æ¥ç¼–å†™å…·ä½“æ­¥éª¤ã€‚

- å®‰è£…ç¯å¢ƒä¾èµ–ã€å·¥å…·
- æ‹‰å– relay æ–‡ä»¶ï¼Œå³æ„å»ºäº§ç‰©
- å¯åŠ¨ relay æœåŠ¡

ç›¸å…³ Dockerfile å‚è€ƒ [Dockerfile.relay.start]

### æ˜¯å¦å¯ç”¨ processing é…ç½®ï¼Ÿ

åœ¨ relay å†…ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½® processing æ¥å¢å¼ºå…¶å¯¹äºæ•°æ®é“¾è·¯çš„å¤„ç†èƒ½åŠ›ã€‚å¦‚æœæœªå¯ç”¨ï¼Œåˆ™ï¼š

- Event normalization ä¼šæ‰§è¡Œæ›´å°‘çš„å¤„ç†
- ä¸ä¼šä» Sentry æ‹‰å–é¡¹ç›®é…ç½®ï¼Œè€Œæ˜¯ä»æœ¬åœ°è·å–æˆ–è€…ç›´æ¥é»˜è®¤å¤„ç†ï¼ˆä¸ `mode` çš„å€¼ç›¸å…³ï¼‰
- Event ä¼šé€šè¿‡ HTTP è½¬å‘è€Œä¸æ˜¯å†™å…¥ Kafka
- é€Ÿç‡é™åˆ¶ä¸å†æ˜¯ä½¿ç”¨ Redis è¿›è¡Œè®¡ç®—
- ä¸ä¼šè¿›è¡Œäº‹ä»¶è¿‡æ»¤

è¿™é‡Œæä¾›ä¸€ä»½å®Œæ•´çš„ relay config.yaml å¸®åŠ©ç†è§£ï¼š

```yaml
relay:
  mode: managed
  upstream: '[sentry web endpoint]'
  host: 0.0.0.0
  port: 3000
logging:
  level: error
  log_failed_payloads: true
processing:
  enabled: true
  kafka_config:
    - { name: 'bootstrap.servers', value: '[kafka host]:[kafka port]' }
    - { name: 'message.max.bytes', value: 50000000 } # 50MB
  redis: redis://[redis host]:[redis port]
  geoip_path: '[geoip file address].mmdb'
limits:
  max_event_size: 10MiB
  max_envelope_size: 100MiB
  max_api_payload_size: 100MiB
cache:
  envelope_buffer_size: 30000
```

## Snuba

:::info

Snuba æ˜¯ CK çš„ä»£ç†æœåŠ¡ï¼Œç”¨æˆ·æŸ¥è¯¢å’Œå†™å…¥æ•°æ®ã€‚

:::

## Database

åˆå§‹åŒ–æœåŠ¡ä¹‹åï¼ŒSentry åœ¨åˆ†åˆ«åœ¨ PGã€ClickHouse åˆ›å»ºè¡¨ï¼Œåœ¨ Kafka å†…åˆ›å»º Topics

### ClickHouse

å‚è€ƒ[ck è¿ç»´è„šæœ¬](https://docs.joyjoy.cc/docs/database/clickhouse)

åœ¨ ClickHouse å†…ï¼ŒSentry ä¼šåˆ›å»ºå¦‚ä¸‹è¡¨ï¼Œç”± Snuba æœåŠ¡å¯¹å…¶è¿›è¡Œä»£ç†ï¼Œè´Ÿè´£æ’å…¥å’Œä»£ç†æŸ¥è¯¢æ•°æ®ï¼š

```
sessions_raw_local

outcomes_raw_local // æ—¶åºæ•°æ®åº“

errors_local

transactions_local
```

## æ³¨æ„äº‹é¡¹

1. æ›´æ–° sentry web æœåŠ¡åï¼ˆå¯¼è‡´ podIp å‘ç”Ÿå˜åŒ–ï¼‰ï¼Œéœ€è¦åœ¨ relay å†…é‡æ–°é…ç½® upstreamï¼Œå¦åˆ™ä¼šå‡ºç°æ— æ³•ä¸ŠæŠ¥çš„æƒ…å†µï¼›
2. memcached æœåŠ¡éœ€è¦æŒ‚è½½åˆ°åŸŸåä¸‹ï¼Œå› æ­¤æ›´æ–°åˆ†ç»„åéœ€è¦é‡æ–°é…ç½® memcached åŸŸåçš„åç«¯å®¹å™¨ï¼›
3. å¼€å‘ sentry plugins åéœ€è¦æ›´æ–° web å’Œ worker-default åˆ†ç»„ï¼Œåˆ†åˆ«å¯¹åº” `sentry run web` å’Œ `sentry run worker default` å¯åŠ¨å‘½ä»¤ï¼›
4. Sentry æœåŠ¡éƒ½è¦æŒ‚åœ¨åŒä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶åœ°å€ï¼Œå¦åˆ™ä¼šå‡ºç° SourceMaps æ–‡ä»¶ä¸Šä¼ å¤±è´¥çš„æƒ…å†µï¼›

### pipy å¯¼è‡´çš„æ„å»ºé—®é¢˜

å› ä¸ºè‡ªéƒ¨ç½² Sentry ç‰ˆæœ¬ä¸º 21.6.3ï¼ŒSentry å®˜æ–¹åœ¨ 2024 å¹´å‡ºäº pipy å®¹é‡è€ƒè™‘ï¼Œåˆ é™¤äº†ä¸€éƒ¨åˆ†å…¬å…±ç‰ˆæœ¬ã€‚**å› æ­¤æ ¹æ® requirements.txt å†…çš„ç‰ˆæœ¬å·ï¼Œæˆ‘ä»¬å¯èƒ½å­˜åœ¨æ‹‰ä¸åˆ°æŒ‡å®šç‰ˆæœ¬çš„åŒ…ï¼Œæˆ–è€…æ‹‰å–çš„åŒ…å’Œæºç ä¸åŒ¹é…çš„æƒ…å†µã€‚**

æ¯”å¦‚ï¼š

```
xmlsec.InternalError: (-1, 'lxml & xmlsec libxml2 library version mismatch')
```

è§£å†³è¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æ—¥å¿—ä¾æ¬¡æ’æŸ¥ï¼Œä¿®æ”¹ requirements.txt å†…å®¹åé‡æ–°ç¼–è¯‘ã€‚ä¸‹é¢è®°å½•å¯èƒ½å­˜åœ¨é—®é¢˜çš„åŒ…ï¼š

```bash
pip show sentry-relay

pip show lxml
pip show xmlsec
pip show sentry-auth-gitlab-v2

dpkg -l | grep libxml2
```
